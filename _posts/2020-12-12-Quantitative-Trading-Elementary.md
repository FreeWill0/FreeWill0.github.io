---
layout:     post
title:      Quantitative Trading Elementary
subtitle:   RiceQuant
date:       2020-12-12
author:     JieKun Liu
header-img: img/the-first.png
catalog:   true
tags:
    - QuantitativeTrading
---


- 量化交易
  - 现代统计学和机器学习的方法
  - 计算机技术 
  -  证券的投资或者分析方法
  - 用数量模型验证及固化这些规律和策略，然后严格执行已固化的策略来指导投资
  - 掌握技能：金融策略、挖掘技术、计算机技术
- 量化交易分类
  - 我们所做的量化交易：市场中性策略（量化分析）
  - 趋势性交易：金融专业出生、对财务、金融市场非常了解（交易员、基金经理）
  - 市场中性策略：计算机专业出身，擅长编程、机器学习技术、数据挖掘技术（量化分析），量化交易人员
  - 高频交易：非常擅长算法编程c/c++ 做交易（算法高手）
- 金融产品及衍生品的投资策略
  - 股票：市场中性策略dominant，少量趋势性交易
  - 期货：趋势性交易dominant
- 量化交易优势
  - 严格的纪律性：人的缺点 程序分析技术可以解决
  - 系统：
    - 多层次，包括在大类资产配置、行业选择、精选个股
    - 多角度，量化交易的投资思想包括宏观周期、市场结构、估值、成长、盈利质量、分析师盈利预测、市场情绪等多个问题
    - 多数据，海量数据处理
  - 靠数学模型取胜
- 总结
  - 股票的量化投资可以说是一种价值投资，量化公司、基金公司等
  - 量化分析是众多投资机构的工具、手段而已
- 什么是量化策略？
  - 一套固定的逻辑来分析判断和决策 量化策略既可以自动执行也可以人工执行
- Target1
  - 构建策略 策略回测 策略分析 框架使用
- 策略运行流程 各个部分
  - 初始运行信息
    - 起始日期：在历史数据回测区间（5-10年）
    - 起始资金：有多少钱用于此策略投资
    - 回测频率：每日交易判断/每分钟交易判断（市场中性，判断周期可能更长，一个月等等）
  - 编写策略的逻辑
    - 运行顺序：
      - 1. init 策略初始化逻辑
      - 2. before_trading 每日开盘之前的操作，比如获取历史行情做一些数据预处理，获取当前账户资金
      - 3. handle_bar：包括交易信号的产生、订单的创建
      -  都具有一个context对象，用于函数之间的内容传递
  - 策略分析
- 策略当中数据获取API和交易的API
  - 数据获取
    - 获取指定行业、板块股票列表
      - index_components
    - history_bars-指定股票合约历史数据 行情数据 交易基本信息
      - history_bars(order_book_id,bar_count,frequency,fields=None,skip_suspend=True,include_now=False)不能在init当中调用
      - 把频率改成'1m' 回测频率必须为分钟回测
        - close = history_bars(context.s1,5,'1m','close')
      - bar_dict对象也可以获取行情数据 只能获取当前运行日期的 不能获取之前日期
    - get_fundamentals-查询财务数据：基本面数据、公司数据
      - 回测的时候主要拿来去选股
      - 回测时不用提供日期数据（获取哪一天的数据）
      - q = query( fundamentals.eod_derivative_indicator.pe_ratio)
        - query( ).filter：过滤大小
        - query( ).order_by：排序
        - query( ).limit( )：限制数量
        - fundamentals.stockcode.in_( )：在指定的股票池当中过滤
      - 通过财务数据选股票，不会每天都会获取，间隔一个星期一个月去获取符合条件的股票
      - scheduler定时器定时数据获取
        - 必须都在init当中使用
        - scheduler.run_daily-每天运行
        - scheduler.run_weekly-每周运行
        - scheduler.run_monthly-每月运行
          - scheduler.run_monthly(get_data,tradingday=1)
          - def get_data(context,bar_dict):
        - 运行的顺序
          - 按月
          - scheduler.run_monthly(get_data,tradingday=1)
          - 2月，2月1号假设为第一个交易日，before_trading -->get_data-->handle_bar
            - 2月其他日期都是：before_trading-->handle_bar
    - 交易逻辑
      - order_share(context.s1,1000)
      - order_target_percent(context.s1,0.1)
      - 交易不能成交的注意事项
        - portfolio内可用资金不足
        - 下单数量不足一手（股票为100股）
        - 当前可卖（平）仓位不足
        - 股票当日停牌
        - 合约已经退市（到期）或未上市
      - 默认每日回测：每日收盘价去进行买入（撮合方式）当前bar收盘价
        - 限价单：挂单：但是市价20.1，指定价格交易，20.5卖出，19.2买入
        - 市价单：目的为了快速成交，当前市价多少，买入，卖出就是多少
        - 滑点的设置影响：在回测当中使用
          - 更好模拟实际交易中订单对市场的冲击，成交价格更高一些
      - 交易的卖空设置：股票默认当天买入，第二天才能卖出，不用设置
    - 投资组合
      - 定义：投资组合是由投资人或金融机构所持有的股票、债券、金融衍生品等组成的集合，目的是分散风险
      - 资金：可用资金，市场价值，总价值
      - 仓位：当前持有的股票代码等相关信息
      - stock_account：也可以查看股票账户的资金信息
    - 策略的评价指标
      - 收益指标
        -  回测收益率：（最终总价值-初始总价值）/ 初始总价值
        -  基准收益：参考的标准，市场表现情况作为标准来看我们的策略，默认以HS300作为基准
        -  年化收益率：平均每年的收益情况，一般比较是以年化收益率去比较
          - 年化达到15%-30%已经算是比较好的策略 年化收益率越高越好
      - 风险指标
        -  风险指标指的是在获得收益的时候，承担一些风险值
        -  最大回撤比率：最大回测最好保持10-30%之间，越小越好
        -  夏普比率：夏普比率越大，说明单位风险所获得的风险回报越高（和无风险利率比较）
          - 达到1.5以上已经是很好的结果 0.7—1.5

